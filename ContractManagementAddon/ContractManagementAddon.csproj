<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <!-- SAP Business One is a 32‑bit application. Compiling add‑ons
         as AnyCPU can lead to BadImageFormatException and reference
         conflicts between x86 and x64 assemblies. Force the build
         to target x86 so that the correct 32‑bit SAP UI and DI
         libraries are loaded at runtime. -->
    <Platform Condition=" '$(Platform)' == '' ">x86</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{29B81D8D-6646-4EE7-9757-5135351EFA76}</ProjectGuid>
    <OutputType>WinExe</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>ContractManagementAddon</RootNamespace>
    <AssemblyName>ContractManagementAddon</AssemblyName>
    <TargetFrameworkVersion>v4.8</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|x86' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <!-- Target the build output to 32‑bit to match SAP Business One -->
    <PlatformTarget>x86</PlatformTarget>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|x86' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <!-- Target the build output to 32‑bit to match SAP Business One -->
    <PlatformTarget>x86</PlatformTarget>
  </PropertyGroup>
  <PropertyGroup>
    <StartupObject>ContractManagementAddon.Program</StartupObject>
  </PropertyGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Drawing" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <!--
      The original project referenced a monolithic `SAPBusinessOneSDK` assembly.
      That assembly bundles both the UI API (SAPbouiCOM) and DI API
      (SAPbobsCOM) and can cause binding conflicts when loaded alongside
      individual interop libraries. In particular, the UI API types in
      `SAPbouiCOM.Framework` were being resolved from a different assembly
      than those referenced in code, resulting in ambiguous or missing
      type errors at build time.

      To resolve these conflicts, remove the `SAPBusinessOneSDK` reference
      and instead reference the specific SAP UI libraries used by this
      add‑on. The `SAPbouiCOM` reference provides the core UI API types,
      and the `SAPbouiCOM.Framework` reference provides the higher‑level
      application framework. If DI API functionality is needed later,
      `SAPbobsCOM` can be added separately without interfering with the UI
      references.
    -->
    <Reference Include="SAPbouiCOM" />
    <Reference Include="SAPbouiCOM.Framework" />
  </ItemGroup>
  <ItemGroup>
    <None Include="Form1.b1f">
      <FormCategory>UserForm</FormCategory>
    </None>
    <Compile Include="Form1.b1f.cs">
      <DependentUpon>Form1.b1f</DependentUpon>
    </Compile>
    <Compile Include="Program.cs" />
    <Compile Include="Menu.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
</Project>
