<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="12.0" DefaultTargets="Build" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup>
    <Configuration Condition=" '$(Configuration)' == '' ">Debug</Configuration>
    <!-- SAP Business One is a 32‑bit application. Compiling add‑ons
         as AnyCPU can lead to BadImageFormatException and reference
         conflicts between x86 and x64 assemblies. Force the build
         to target x86 so that the correct 32‑bit SAP UI and DI
         libraries are loaded at runtime. -->
    <Platform Condition=" '$(Platform)' == '' ">x86</Platform>
    <ProductVersion>8.0.30703</ProductVersion>
    <SchemaVersion>2.0</SchemaVersion>
    <ProjectGuid>{29B81D8D-6646-4EE7-9757-5135351EFA76}</ProjectGuid>
    <OutputType>WinExe</OutputType>
    <AppDesignerFolder>Properties</AppDesignerFolder>
    <RootNamespace>ContractManagementAddon</RootNamespace>
    <AssemblyName>ContractManagementAddon</AssemblyName>
    <TargetFrameworkVersion>v4.8</TargetFrameworkVersion>
    <FileAlignment>512</FileAlignment>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Debug|x86' ">
    <DebugSymbols>true</DebugSymbols>
    <DebugType>full</DebugType>
    <Optimize>false</Optimize>
    <OutputPath>bin\Debug\</OutputPath>
    <DefineConstants>DEBUG;TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <!-- Target the build output to 32‑bit to match SAP Business One -->
    <PlatformTarget>x86</PlatformTarget>
  </PropertyGroup>
  <PropertyGroup Condition=" '$(Configuration)|$(Platform)' == 'Release|x86' ">
    <DebugType>pdbonly</DebugType>
    <Optimize>true</Optimize>
    <OutputPath>bin\Release\</OutputPath>
    <DefineConstants>TRACE</DefineConstants>
    <ErrorReport>prompt</ErrorReport>
    <WarningLevel>4</WarningLevel>
    <!-- Target the build output to 32‑bit to match SAP Business One -->
    <PlatformTarget>x86</PlatformTarget>
  </PropertyGroup>
  <PropertyGroup>
    <StartupObject>ContractManagementAddon.Program</StartupObject>
    <SAPSDKPath>$(MSBuildProjectDirectory)\..\sap-sdk</SAPSDKPath>
  </PropertyGroup>
  <ItemGroup>
    <ProjectReference Include="..\ContractManagement.Core\ContractManagement.Core.csproj">
      <Project>{6C3A2CB6-9A27-4F5D-9D33-8A0F4D7749C4}</Project>
      <Name>ContractManagement.Core</Name>
    </ProjectReference>
    <ProjectReference Include="..\ContractManagement.Infrastructure\ContractManagement.Infrastructure.csproj">
      <Project>{8B3B8E0F-7C2B-4D3F-B5E9-3A6B9A6E6C11}</Project>
      <Name>ContractManagement.Infrastructure</Name>
    </ProjectReference>
  </ItemGroup>
  <ItemGroup>
    <Reference Include="System" />
    <Reference Include="System.Configuration" />
    <Reference Include="System.Core" />
    <Reference Include="System.Xml.Linq" />
    <Reference Include="System.Data.DataSetExtensions" />
    <Reference Include="Microsoft.CSharp" />
    <Reference Include="System.Data" />
    <Reference Include="System.Drawing" />
    <Reference Include="System.Windows.Forms" />
    <Reference Include="System.Xml" />
    <!--
      Use individual Interop DLLs instead of the monolithic `SAPBusinessOneSDK` assembly
      to avoid binding conflicts. The individual Interop libraries are:
      - Interop.SAPbouiCOM.dll: Provides UI API types and SAPbouiCOM.Framework
      - Interop.SAPbobsCOM.dll: Provides DI API types (used via Infrastructure project)

      These are loaded at runtime by the AssemblyResolve event handler in Program.cs,
      which searches the sap-sdk folder structure for the DLL files.
    -->
    <Reference Include="Interop.SAPbouiCOM">
      <HintPath>$(SAPSDKPath)\UI API\Lib\Interop.SAPbouiCOM.dll</HintPath>
      <EmbedInteropTypes>False</EmbedInteropTypes>
    </Reference>
    <Reference Include="Interop.SAPbobsCOM">
      <HintPath>$(SAPSDKPath)\DI API\Lib\Interop.SAPbobsCOM.dll</HintPath>
      <EmbedInteropTypes>False</EmbedInteropTypes>
    </Reference>
    <!-- SAPbouiCOM.Framework is a wrapper namespace around the UI API -->
    <Reference Include="SAPbouiCOM.Framework">
      <HintPath>$(SAPSDKPath)\UI API\Lib\Interop.SAPbouiCOM.dll</HintPath>
      <EmbedInteropTypes>False</EmbedInteropTypes>
    </Reference>
  </ItemGroup>
  <ItemGroup>
    <None Include="Form1.b1f">
      <FormCategory>UserForm</FormCategory>
    </None>
    <Compile Include="ConfigForm.cs" />
    <Compile Include="Form1.b1f.cs">
      <DependentUpon>Form1.b1f</DependentUpon>
    </Compile>
    <Compile Include="IcpCommands.cs" />
    <Compile Include="Log.cs" />
    <Compile Include="Menu.cs" />
    <Compile Include="Program.cs" />
    <Compile Include="Properties\AssemblyInfo.cs" />
    <Compile Include="RetentionReleaseForm.cs" />
    <Compile Include="Startup.cs" />
  </ItemGroup>
  <Import Project="$(MSBuildToolsPath)\Microsoft.CSharp.targets" />
</Project>
